<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Contents 1. Packaging with openSUSE Build Service (OBS) 1. Packaging with openSUSE Build Service (OBS) Under OBS, the build &amp; install procedure has to be performed using Makefile.LIP6. Note While...">
        <meta name="keywords" content="">
        <link rel="icon" href="../favicon.ico">

        <title>Packaging Notes - Coriolis VLSI CAD Tools</title>

        <!-- Stylesheets -->
        <link href="../theme/css/bootstrap.css" rel="stylesheet">
        <link href="../theme/css/fonts.css"     rel="stylesheet">
        <link href="../theme/css/nest.css"      rel="stylesheet">
        <link href="../theme/css/pygment.css"   rel="stylesheet">
        <link href="../theme/css/coriolis.css"  rel="stylesheet">
        <!-- /Stylesheets -->

        <script src="../theme/js/jquery.min.js"></script>
        <script src="../theme/js/bootstrap.min.js"></script>

        <!-- RSS Feeds -->
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->



    </head>

    <body>
      <!-- Header -->
    <div class="header-container" style="background: linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2)), url('../images/common/layout-motif-faded-4.png'); background-position: center; ">


      <!--
      <div class="container">
        <nav class="navbar navbar-default">
          <div class="container-fluid">
            <div class="navbar-header">
              <a class="navbar-brand" href="../"><img class="mr20" src="../images/common/Coriolis-logo-white-4-small.png" alt="logo">Coriolis VLSI CAD Tools</a>
            </div>
            <ul class="nav navbar-nav">
                   <li><a href="../pages/github.html">Git</a></li>
                   <li><a href="../pages/documentation.html">Documentation</a></li>
              <li class="dropdown">
                <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                  <span class="caret"></span>Topics
                </button>
                <ul class="dropdown-menu">
                  <li><a class="dropdown-item " href="../pages/homepage.html">Coriolis <span class="sc">vlsi</span> Backend Tools</a></li>
                  <li><a class="dropdown-item " href="../pages/symbolic-layout.html">Symbolic Layout</a></li>
                </ul>
              </li>
            </ul>
          </div>
        </nav>
      </div> <!-- navbar container -->
      -->

      <!-- Static navbar -->
      <div class="container">
        <div class="header-nav">
          <div class="header-logo">
            <a class="pull-left" href="../"><img class="mr20" src="../images/common/Coriolis-logo-white-4-small.png" alt="logo">Coriolis VLSI CAD Tools</a>
          </div>
          <div class="nav pull-right">
                <a href="../pages/github.html">Git</a>
                <a href="../pages/documentation.html">Documentation</a>
          </div>
          <div class="nav pull-right">
            <div class="dropdown">
              <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                <span class="caret"></span>Topics
              </button>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item " href="../pages/homepage.html">Coriolis <span class="sc">vlsi</span> Backend Tools</a></li>
                <li><a class="dropdown-item " href="../pages/symbolic-layout.html">Symbolic Layout</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <!-- /Static navbar -->

        <!-- Header -->
    <div class="container header-wrapper">
        <div class="row">
              <div class="col-lg-12">
                  <div class="header-content">
                      <a href="https://www.lip6.fr/"><img class="mr20" height="60px" src="../images/common/LogoLIP6Blanc.png" alt="LIP6"></a>
                      <a href="https://www.sorbonne-universite.fr/"><img class="mr20" height="60px" src="../images/common/logo-SU-blanc-700px.png" alt="Sorbonne Universite"></a>
                      <a href="https://www.cnrs.fr/"><img class="mr20" height="60px" src="../images/common/LOGO-cnrs-white-large.png" alt="CNRS"></a>
                      <h1 class="header-title text-uppercase">Packaging Notes</h1>
                      <div class="header-underline"></div>
                  </div>
              </div>
        </div>
    </div>
        <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
    <div class="container content">
        <!-- -*- mode: rst; explicit-buffer-name: "Packaging_HTML.rst<pelican>" -*- -->
<!-- -*- Mode: rst; explicit-buffer-name: "definition.rst<documentation/etc>" -*- -->
<!-- HTML/LaTeX backends mixed macros. -->
<!-- Acronyms & names. -->
<!-- URLs -->
<!-- Standard CAO/VLSI Concepts. -->
<!-- Alliance & MBK Concepts -->
<!-- Hurricane Concepts. -->
<!-- Link to Hurricane doc (Doxygen) -->
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#packaging-with-opensuse-build-service-obs" id="toc-entry-1">1. Packaging with openSUSE Build Service (OBS)</a></li>
</ul>
</div>
<!-- -*- Mode: rst -*- -->
<div class="section" id="packaging-with-opensuse-build-service-obs">
<h2><a class="toc-backref" href="#toc-entry-1">1. Packaging with openSUSE Build Service (OBS)</a></h2>
<p>Under OBS, the build &amp; install procedure has to be performed using <tt class="docutils literal">Makefile.LIP6</tt>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">While the git repository and the tool itself is named <tt class="docutils literal">coriolis</tt>,
in order to minimize confusion, the associated package is <tt class="docutils literal"><span class="pre">coriolis-eda</span></tt>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The devel package is currently almost empty. The development files
like C++ headers are not installed (yet) as it was easier when
making a PyPI package.</p>
</div>
<p>Summary of files involved in the packaging process:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">&lt;&gt;/Makefile.LIP6</span></tt></li>
<li><tt class="docutils literal"><span class="pre">&lt;&gt;/packaging/coriolis-eda.spec</span></tt></li>
<li><tt class="docutils literal"><span class="pre">&lt;&gt;/packaging/patchenv.sh</span></tt></li>
<li><tt class="docutils literal"><span class="pre">&lt;&gt;/packaging/find_files.sh</span></tt></li>
<li><tt class="docutils literal"><span class="pre">&lt;&gt;/packaging/mkArchives.sh</span></tt></li>
<li><tt class="docutils literal"><span class="pre">&lt;&gt;/packaging/coloquinte-clamp.patch</span></tt>, fix a missing include (until fixed upstream).</li>
<li><tt class="docutils literal"><span class="pre">&lt;&gt;/packaging/git-archive-all.sh</span></tt>, borrowed from the internet.</li>
</ul>
<div class="section" id="virtual-environement-snapshot">
<h3>1.1 Virtual environement snapshot</h3>
<ul class="simple">
<li>Formerly, <span class="cb">pdm</span> was installed in the global environment of the user,
<tt class="docutils literal"><span class="pre">~/.local/bin</span></tt> with <span class="cb">pip</span>. Now we install it <em>inside</em> the virtual
environment dedicated to build Coriolis (<tt class="docutils literal"><span class="pre">&lt;&gt;/coriolis/.venv</span></tt>).</li>
<li>Once all the dependencies are installed by <span class="cb">pdm</span> in the dedicated
virtual environment, <em>we do not need</em> to go through <span class="cb">pdm</span> to run
the build and install commands. As a consequence, once the snapshot
is taken from a valid environment on the reference machine we only
need to <em>activate</em> the virtual environment and run the commands right
away. The <tt class="docutils literal">Makefile.LIP6</tt> has been simplificated in that way.</li>
<li>To run <span class="cb">pelican</span> and generate the documentation, we need at least
Python 3.8 for the <tt class="docutils literal">watchfiles</tt> module to be available. And, as
it is binary dependent, we need to erase it from the virtual environment
and install the one provided by the OS distribution. Hence the the
dependency over <tt class="docutils literal"><span class="pre">python311-devel</span></tt> (SUSE) and <tt class="docutils literal"><span class="pre">python3.11-devel</span></tt>
(RHEL clones).</li>
<li>A second problem with <span class="cb">pelican</span> is the incompatibilities/bug between
<span class="cb">doxygen</span> and <span class="cb">ghostscript</span> in some older distributions.
It completely prevent the rebuild of the documentation and it is
outside our remit to rebuild upgraded versions of those programs.
The workaround is, for those problematic distributions, to
provide a snapshot of the documentation. It should not change
as fast as the sources.</li>
</ul>
<p>A dedicated script <tt class="docutils literal">patchenv.sh</tt> has been created to manage the
virtual environment package removal, when needed.</p>
<ul class="simple">
<li>As the environment is being patched, the modification time of
the directories are made more recents. This may trick the
<tt class="docutils literal">Makefile.LIP6</tt> rules to try to reinstall <span class="cb">pdm</span> or some other
dependency. In order to avoid that, we have to <tt class="docutils literal">touch</tt> the
relevant files. For now, <span class="cb">pdm</span>, <span class="cb">meson</span> &amp; <span class="cb">pelican</span>.</li>
</ul>
</div>
<div class="section" id="helpers-scripts-for-rpm">
<h3>1.2 Helpers scripts for RPM</h3>
<p>We also provides a <tt class="docutils literal">find_files.sh</tt> script to generate the various <tt class="docutils literal">%files</tt>
section of RPM packages. It is specifically tailored to Coriolis and in the
event of changes in the way Coriolis is installed it must be reviewed.</p>
</div>
<div class="section" id="making-archives-and-pushing-to-obs">
<h3>1.3 Making archives and pushing to OBS</h3>
<p>A dedicated script has been made to handle the whole process of making
archives and pushing them to OBS : <tt class="docutils literal">mkArchives.sh</tt>.</p>
<ul class="simple">
<li>Using the <tt class="docutils literal"><span class="pre">git-archive-all.sh</span></tt> script, an archive of the current
<tt class="docutils literal">HEAD</tt> of the branch we are in is taken, <em>along with the submodules</em>.</li>
<li>It copy all the configuration files from <tt class="docutils literal"><span class="pre">&lt;&gt;/coriolis/packaging/</span></tt>
into the checkout of the OBS package under <tt class="docutils literal"><span class="pre">&lt;&gt;/../coriolis-obs/home:jpc-lip6/coriolis-eda</span></tt>.</li>
</ul>
</div>
</div>

    </div>
        <!-- /Content --> 

        <!-- Footer -->
        <div class="footer gradient-2">
            <div class="container footer-container ">
                <div class="row">
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Map</div>
                        <ul class="list-unstyled">
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-2">
                        <div class="footer-title">Social</div>
                        <ul class="list-unstyled">
                            <li><a href="element://vector/webapp/#/room/%23coriolis%3Amatrix.org?via=matrix.or" target="_blank">Matrix</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Links</div>
                        <ul class="list-unstyled">
                            <li><a href="https://coriolis.lip6.fr/" target="_blank">Alliance/Coriolis</a></li>
                            <li><a href="https://largo.lip6.fr/" target="_blank">CIAN Team Website</a></li>
                        </ul>
                    </div> 
                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-4">
                        <p class="pull-right text-right">
                            <small><em>Proudly powered by <a href="http://docs.getpelican.com/" target="_blank">pelican</a></em></small><br/>
			    <small><em><span class="sc">NEST</span> theme by <a href="https://github.com/molivier" target="_blank">molivier</a></em></small><br/>
                            <small>Copyright © 2020-2020 Sorbonne Universite</small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Footer -->
    </body>
</html>